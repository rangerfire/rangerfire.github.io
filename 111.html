<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title></title>
    <script src="xlsx.full.min.js"></script>
</head>

<body>
    <button onclick="Export(jsono)">Export</button>
    <!--
            ����a��ǩ����Ҫ����
        -->
    <a href="" download="totaltime.xlsx" id="hf"></a>
    <script>
        var jsono = [{ //��������
            "hour": 100,
            "min": 10,
            "sec": 1
        }];
        var tmpDown; //�����Ķ����ƶ���
        function Export(json, type) {
            var tmpdata = json[0];
            json.unshift({});
            var keyMap = []; //��ȡkeys
            //keyMap =Object.keys(json[0]);
            for (var k in tmpdata) {
                keyMap.push(k);
                json[0][k] = k;
            }
          var tmpdata = [];//��������ת���õ�json 
                json.map((v, i) => keyMap.map((k, j) => Object.assign({}, {
                    v: v[k],
                    position: (j > 25 ? getCharCol(j) : String.fromCharCode(65 + j)) + (i + 1)
                }))).reduce((prev, next) => prev.concat(next)).forEach((v, i) => tmpdata[v.position] = {
                    v: v.v
                });
                var outputPos = Object.keys(tmpdata); //��������,����������A1��D10
                var tmpWB = {
                    SheetNames: ['mySheet'], //�����ı�����
                    Sheets: {
                        'mySheet': Object.assign({},
                            tmpdata, //����
                            {
                                '!ref': outputPos[0] + ':' + outputPos[outputPos.length - 1] //������������
                            })
                    }
                };
                tmpDown = new Blob([s2ab(XLSX.write(tmpWB, 
                    {bookType: (type == undefined ? 'xlsx':type),bookSST: false, type: 'binary'}//�������������������嵼���ĸ�ʽ����
                    ))], {
                    type: ""
                }); //���������ƶ���д��ת���õ��ֽ���
            var href = URL.createObjectURL(tmpDown); //��������������
            document.getElementById("hf").href = href; //����a��ǩ
            document.getElementById("hf").click(); //ģ������ʵ������
            setTimeout(function() { //��ʱ�ͷ�
                URL.revokeObjectURL(tmpDown); //��URL.revokeObjectURL()���ͷ�����object URL
            }, 100);
        }

        function s2ab(s) { //�ַ���ת�ַ���
            var buf = new ArrayBuffer(s.length);
            var view = new Uint8Array(buf);
            for (var i = 0; i != s.length; ++i) view[i] = s.charCodeAt(i) & 0xFF;
            return buf;
        }
         // ��ָ������Ȼ��ת��Ϊ26���Ʊ�ʾ��ӳ����ϵ��[0-25] -> [A-Z]��
        function getCharCol(n) {
            let temCol = '',
            s = '',
            m = 0
            while (n > 0) {
                m = n % 26 + 1
                s = String.fromCharCode(m + 64) + s
                n = (n - m) / 26
            }
            return s
        }
    </script>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"left","width":180,"height":360},"mobile":{"show":true},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>

</html>